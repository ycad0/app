/*!
 TableTools 2.2.4
 2009-2015 SpryMedia Ltd - datatables.net/license

 ZeroClipboard 1.0.4
 Author: Joseph Huckaby - MIT licensed
*/

var TableTools;(function(e,t,n){var r=function(r,i){var s={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(e){return"string"==typeof e&&(e=t.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){this.className=this.className.replace(RegExp("\\s*"+e+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},e.hasClass=function(e){return!!this.className.match(RegExp("\\s*"+e+"\\s*"))}),e},setMoviePath:function(e){this.moviePath=e},dispatch:function(e,t,n){(e=this.clients[e])&&e.receiveEvent(t,n)},register:function(e,t){this.clients[e]=t},getDOMObjectPosition:function(e){var t={left:0,top:0,width:e.width?e.width:e.offsetWidth,height:e.height?e.height:e.offsetHeight};""!==e.style.width&&(t.width=e.style.width.replace("px","")),""!==e.style.height&&(t.height=e.style.height.replace("px",""));for(;e;)t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.offsetParent;return t},Client:function(e){this.handlers={},this.id=s.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,s.register(this.id,this),e&&this.glue(e)}};s.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(e,n){this.domElement=s.$(e);var r=99;this.domElement.style.zIndex&&(r=parseInt(this.domElement.style.zIndex,10)+1);var i=s.getDOMObjectPosition(this.domElement);this.div=t.createElement("div");var o=this.div.style;o.position="absolute",o.left="0px",o.top="0px",o.width=i.width+"px",o.height=i.height+"px",o.zIndex=r,"undefined"!=typeof n&&""!==n&&(this.div.title=n),0!==i.width&&0!==i.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(i.width,i.height).replace(/&/g,"&amp;"))},positionElement:function(){var e=s.getDOMObjectPosition(this.domElement),t=this.div.style;t.position="absolute",t.width=e.width+"px",t.height=e.height+"px",0!==e.width&&0!==e.height&&(this.sized=!0,t=this.div.childNodes[0],t.width=e.width,t.height=e.height)},getHTML:function(e,t){var n="",r="id="+this.id+"&width="+e+"&height="+t;if(navigator.userAgent.match(/MSIE/))var i=location.href.match(/^https/i)?"https://":"http://",n=n+('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+i+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+s.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+r+'"/><param name="wmode" value="transparent"/></object>');else n+='<embed id="'+this.movieId+'" src="'+s.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+r+'" wmode="transparent" />';return n},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var e=t.getElementsByTagName("body")[0];try{e.removeChild(this.div)}catch(n){}this.div=this.domElement=null}},reposition:function(e){e&&((this.domElement=s.$(e))||this.hide());if(this.domElement&&this.div){var e=s.getDOMObjectPosition(this.domElement),t=this.div.style;t.left=""+e.left+"px",t.top=""+e.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(e){this.clipText+=e,this.ready&&this.movie.appendText(e)},setText:function(e){this.clipText=e,this.ready&&this.movie.setText(e)},setCharSet:function(e){this.charSet=e,this.ready&&this.movie.setCharSet(e)},setBomInc:function(e){this.incBom=e,this.ready&&this.movie.setBomInc(e)},setFileName:function(e){this.fileName=e,this.ready&&this.movie.setFileName(e)},setAction:function(e){this.action=e,this.ready&&this.movie.setAction(e)},addEventListener:function(e,t){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},setHandCursor:function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},setCSSEffects:function(e){this.cssEffects=!!e},receiveEvent:function(n,r){var i,n=n.toString().toLowerCase().replace(/^on/,"");switch(n){case"load":this.movie=t.getElementById(this.movieId);if(!this.movie){i=this,setTimeout(function(){i.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){i=this,setTimeout(function(){i.receiveEvent("load",null)},100),this.ready=!0;return}this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setCharSet(this.charSet),this.movie.setBomInc(this.incBom),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[n])for(var s=0,o=this.handlers[n].length;s<o;s++){var u=this.handlers[n][s];"function"==typeof u?u(this,r):"object"==typeof u&&2==u.length?u[0][u[1]](this,r):"string"==typeof u&&e[u](this,r)}}},e.ZeroClipboard_TableTools=s;var o=jQuery;return TableTools=function(e,t){return!this instanceof TableTools&&alert("Warning: TableTools must be initialised with the keyword 'new'"),this.s={that:this,dt:o.fn.dataTable.Api?(new o.fn.dataTable.Api(e)).settings()[0]:e.fnSettings(),print:{saveStart:-1,saveLength:-1,saveScroll:-1,funcEnd:function(){}},buttonCounter:0,select:{type:"",selected:[],preRowSelect:null,postSelected:null,postDeselected:null,all:!1,selectedClass:""},custom:{},swfPath:"",buttonSet:[],master:!1,tags:{}},this.dom={container:null,table:null,print:{hidden:[],message:null},collection:{collection:null,background:null}},this.classes=o.extend(!0,{},TableTools.classes),this.s.dt.bJUI&&o.extend(!0,this.classes,TableTools.classes_themeroller),this.fnSettings=function(){return this.s},"undefined"==typeof t&&(t={}),TableTools._aInstances.push(this),this._fnConstruct(t),this},TableTools.prototype={fnGetSelected:function(e){var t=[],n=this.s.dt.aoData,r=this.s.dt.aiDisplay,i;if(e){e=0;for(i=r.length;e<i;e++)n[r[e]]._DTTT_selected&&t.push(n[r[e]].nTr)}else{e=0;for(i=n.length;e<i;e++)n[e]._DTTT_selected&&t.push(n[e].nTr)}return t},fnGetSelectedData:function(){var e=[],t=this.s.dt.aoData,n,r;n=0;for(r=t.length;n<r;n++)t[n]._DTTT_selected&&e.push(this.s.dt.oInstance.fnGetData(n));return e},fnGetSelectedIndexes:function(e){var t=[],n=this.s.dt.aoData,r=this.s.dt.aiDisplay,i;if(e){e=0;for(i=r.length;e<i;e++)n[r[e]]._DTTT_selected&&t.push(r[e])}else{e=0;for(i=n.length;e<i;e++)n[e]._DTTT_selected&&t.push(e)}return t},fnIsSelected:function(e){return e=this.s.dt.oInstance.fnGetPosition(e),!0===this.s.dt.aoData[e]._DTTT_selected?!0:!1},fnSelectAll:function(e){this._fnRowSelect(e?this.s.dt.aiDisplay:this.s.dt.aoData)},fnSelectNone:function(e){this._fnRowDeselect(this.fnGetSelectedIndexes(e))},fnSelect:function(e){"single"==this.s.select.type&&this.fnSelectNone(),this._fnRowSelect(e)},fnDeselect:function(e){this._fnRowDeselect(e)},fnGetTitle:function(e){var n="";return"undefined"!=typeof e.sTitle&&""!==e.sTitle?n=e.sTitle:(e=t.getElementsByTagName("title"),0<e.length&&(n=e[0].innerHTML)),4>"ยก".toString().length?n.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):n.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},fnCalcColRatios:function(e){var t=this.s.dt.aoColumns,e=this._fnColumnTargets(e.mColumns),n=[],r=0,i=0,s,o;s=0;for(o=e.length;s<o;s++)e[s]&&(r=t[s].nTh.offsetWidth,i+=r,n.push(r));s=0;for(o=n.length;s<o;s++)n[s]/=i;return n.join("	")},fnGetTableData:function(e){if(this.s.dt)return this._fnGetDataTablesData(e)},fnSetText:function(e,t){this._fnFlashSetText(e,t)},fnResizeButtons:function(){for(var e in s.clients)if(e){var t=s.clients[e];"undefined"!=typeof t.domElement&&t.domElement.parentNode&&t.positionElement()}},fnResizeRequired:function(){for(var e in s.clients)if(e){var t=s.clients[e];if("undefined"!=typeof t.domElement&&t.domElement.parentNode==this.dom.container&&!1===t.sized)return!0}return!1},fnPrint:function(e,t){t===n&&(t={}),e===n||e?this._fnPrintStart(t):this._fnPrintEnd()},fnInfo:function(e,t){var n=o("<div/>").addClass(this.classes.print.info).html(e).appendTo("body");setTimeout(function(){n.fadeOut("normal",function(){n.remove()})},t)},fnContainer:function(){return this.dom.container},_fnConstruct:function(e){var n=this;this._fnCustomiseSettings(e),this.dom.container=t.createElement(this.s.tags.container),this.dom.container.className=this.classes.container,"none"!=this.s.select.type&&this._fnRowSelectConfig(),this._fnButtonDefinations(this.s.buttonSet,this.dom.container),this.s.dt.aoDestroyCallback.push({sName:"TableTools",fn:function(){o(n.s.dt.nTBody).off("click.DTTT_Select",n.s.custom.sRowSelector).off("mousedown.DTTT_Select","tr").off("mouseup.DTTT_Select","tr"),o(n.dom.container).empty();var e=o.inArray(n,TableTools._aInstances);-1!==e&&TableTools._aInstances.splice(e,1)}})},_fnCustomiseSettings:function(e){"undefined"==typeof this.s.dt._TableToolsInit&&(this.s.master=!0,this.s.dt._TableToolsInit=!0),this.dom.table=this.s.dt.nTable,this.s.custom=o.extend({},TableTools.DEFAULTS,e),this.s.swfPath=this.s.custom.sSwfPath,"undefined"!=typeof s&&(s.moviePath=this.s.swfPath),this.s.select.type=this.s.custom.sRowSelect,this.s.select.preRowSelect=this.s.custom.fnPreRowSelect,this.s.select.postSelected=this.s.custom.fnRowSelected,this.s.select.postDeselected=this.s.custom.fnRowDeselected,this.s.custom.sSelectedClass&&(this.classes.select.row=this.s.custom.sSelectedClass),this.s.tags=this.s.custom.oTags,this.s.buttonSet=this.s.custom.aButtons},_fnButtonDefinations:function(e,t){for(var n,r=0,i=e.length;r<i;r++){if("string"==typeof e[r]){if("undefined"==typeof TableTools.BUTTONS[e[r]]){alert("TableTools: Warning - unknown button type: "+e[r]);continue}n=o.extend({},TableTools.BUTTONS[e[r]],!0)}else{if("undefined"==typeof TableTools.BUTTONS[e[r].sExtends]){alert("TableTools: Warning - unknown button type: "+e[r].sExtends);continue}n=o.extend({},TableTools.BUTTONS[e[r].sExtends],!0),n=o.extend(n,e[r],!0)}(n=this._fnCreateButton(n,o(t).hasClass(this.classes.collection.container)))&&t.appendChild(n)}},_fnCreateButton:function(e,t){var n=this._fnButtonBase(e,t);if(e.sAction.match(/flash/)){if(!this._fnHasFlash())return!1;this._fnFlashConfig(n,e)}else"text"==e.sAction?this._fnTextConfig(n,e):"div"==e.sAction?this._fnTextConfig(n,e):"collection"==e.sAction&&(this._fnTextConfig(n,e),this._fnCollectionConfig(n,e));return-1!==this.s.dt.iTabIndex&&o(n).attr("tabindex",this.s.dt.iTabIndex).attr("aria-controls",this.s.dt.sTableId).on("keyup.DTTT",function(e){13===e.keyCode&&(e.stopPropagation(),o(this).trigger("click"))}).on("mousedown.DTTT",function(t){e.sAction.match(/flash/)||t.preventDefault()}),n},_fnButtonBase:function(e,n){var r,i,s;n?(r=e.sTag&&"default"!==e.sTag?e.sTag:this.s.tags.collection.button,i=e.sLinerTag&&"default"!==e.sLinerTag?e.sLiner:this.s.tags.collection.liner,s=this.classes.collection.buttons.normal):(r=e.sTag&&"default"!==e.sTag?e.sTag:this.s.tags.button,i=e.sLinerTag&&"default"!==e.sLinerTag?e.sLiner:this.s.tags.liner,s=this.classes.buttons.normal),r=t.createElement(r),i=t.createElement(i);var o=this._fnGetMasterSettings();return r.className=s+" "+e.sButtonClass,r.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+o.buttonCounter),r.appendChild(i),i.innerHTML=e.sButtonText,o.buttonCounter++,r},_fnGetMasterSettings:function(){if(this.s.master)return this.s;for(var e=TableTools._aInstances,t=0,n=e.length;t<n;t++)if(this.dom.table==e[t].s.dt.nTable)return e[t].s},_fnCollectionConfig:function(e,n){var r=t.createElement(this.s.tags.collection.container);r.style.display="none",r.className=this.classes.collection.container,n._collection=r,t.body.appendChild(r),this._fnButtonDefinations(n.aButtons,r)},_fnCollectionShow:function(n,r){var i=this,s=o(n).offset(),u=r._collection,a=s.left,s=s.top+o(n).outerHeight(),f=o(e).height(),l=o(t).height(),c=o(e).width(),h=o(t).width();u.style.position="absolute",u.style.left=a+"px",u.style.top=s+"px",u.style.display="block",o(u).css("opacity",0);var p=t.createElement("div");p.style.position="absolute",p.style.left="0px",p.style.top="0px",p.style.height=(f>l?f:l)+"px",p.style.width=(c>h?c:h)+"px",p.className=this.classes.collection.background,o(p).css("opacity",0),t.body.appendChild(p),t.body.appendChild(u),f=o(u).outerWidth(),c=o(u).outerHeight(),a+f>h&&(u.style.left=h-f+"px"),s+c>l&&(u.style.top=s-c-o(n).outerHeight()+"px"),this.dom.collection.collection=u,this.dom.collection.background=p,setTimeout(function(){o(u).animate({opacity:1},500),o(p).animate({opacity:.25},500)},10),this.fnResizeButtons(),o(p).click(function(){i._fnCollectionHide.call(i,null,null)})},_fnCollectionHide:function(e,t){(null===t||"collection"!=t.sExtends)&&null!==this.dom.collection.collection&&(o(this.dom.collection.collection).animate({opacity:0},500,function(){this.style.display="none"}),o(this.dom.collection.background).animate({opacity:0},500,function(){this.parentNode.removeChild(this)}),this.dom.collection.collection=null,this.dom.collection.background=null)},_fnRowSelectConfig:function(){if(this.s.master){var e=this,t=this.s.dt;o(t.nTable).addClass(this.classes.select.table),"os"===this.s.select.type&&(o(t.nTBody).on("mousedown.DTTT_Select","tr",function(e){e.shiftKey&&o(t.nTBody).css("-moz-user-select","none").one("selectstart.DTTT_Select","tr",function(){return!1})}),o(t.nTBody).on("mouseup.DTTT_Select","tr",function(){o(t.nTBody).css("-moz-user-select","")})),o(t.nTBody).on("click.DTTT_Select",this.s.custom.sRowSelector,function(n){var r=this.nodeName.toLowerCase()==="tr"?this:o(this).parents("tr")[0],i=e.s.select,s=e.s.dt.oInstance.fnGetPosition(r);if(r.parentNode==t.nTBody&&t.oInstance.fnGetData(r)!==null){if(i.type=="os")if(n.ctrlKey||n.metaKey)e.fnIsSelected(r)?e._fnRowDeselect(r,n):e._fnRowSelect(r,n);else if(n.shiftKey){var u=e.s.dt.aiDisplay.slice(),f=o.inArray(i.lastRow,u),l=o.inArray(s,u);if(e.fnGetSelected().length===0||f===-1)u.splice(o.inArray(s,u)+1,u.length);else{if(f>l)var c=l,l=f,f=c;u.splice(l+1,u.length),u.splice(0,f)}e.fnIsSelected(r)?(u.splice(o.inArray(s,u),1),e._fnRowDeselect(u,n)):e._fnRowSelect(u,n)}else e.fnIsSelected(r)&&e.fnGetSelected().length===1?e._fnRowDeselect(r,n):(e.fnSelectNone(),e._fnRowSelect(r,n));else e.fnIsSelected(r)?e._fnRowDeselect(r,n):i.type=="single"?(e.fnSelectNone(),e._fnRowSelect(r,n)):i.type=="multi"&&e._fnRowSelect(r,n);i.lastRow=s}}),t.oApi._fnCallbackReg(t,"aoRowCreatedCallback",function(n,r,i){t.aoData[i]._DTTT_selected&&o(n).addClass(e.classes.select.row)},"TableTools-SelectAll")}},_fnRowSelect:function(e,t){var n=this._fnSelectData(e),r=[],i,s;i=0;for(s=n.length;i<s;i++)n[i].nTr&&r.push(n[i].nTr);if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,t,r,!0)){i=0;for(s=n.length;i<s;i++)n[i]._DTTT_selected=!0,n[i].nTr&&o(n[i].nTr).addClass(this.classes.select.row);null!==this.s.select.postSelected&&this.s.select.postSelected.call(this,r),TableTools._fnEventDispatch(this,"select",r,!0)}},_fnRowDeselect:function(e,t){var n=this._fnSelectData(e),r=[],i,s;i=0;for(s=n.length;i<s;i++)n[i].nTr&&r.push(n[i].nTr);if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,t,r,!1)){i=0;for(s=n.length;i<s;i++)n[i]._DTTT_selected=!1,n[i].nTr&&o(n[i].nTr).removeClass(this.classes.select.row);null!==this.s.select.postDeselected&&this.s.select.postDeselected.call(this,r),TableTools._fnEventDispatch(this,"select",r,!1)}},_fnSelectData:function(e){var t=[],n,r,i;if(e.nodeName)n=this.s.dt.oInstance.fnGetPosition(e),t.push(this.s.dt.aoData[n]);else if("undefined"!=typeof e.length){r=0;for(i=e.length;r<i;r++)e[r].nodeName?(n=this.s.dt.oInstance.fnGetPosition(e[r]),t.push(this.s.dt.aoData[n])):"number"==typeof e[r]?t.push(this.s.dt.aoData[e[r]]):t.push(e[r])}else"number"==typeof e?t.push(this.s.dt.aoData[e]):t.push(e);return t},_fnTextConfig:function(e,t){var n=this;null!==t.fnInit&&t.fnInit.call(this,e,t),""!==t.sToolTip&&(e.title=t.sToolTip),o(e).hover(function(){t.fnMouseover!==null&&t.fnMouseover.call(this,e,t,null)},function(){t.fnMouseout!==null&&t.fnMouseout.call(this,e,t,null)}),null!==t.fnSelect&&TableTools._fnEventListen(this,"select",function(r){t.fnSelect.call(n,e,t,r)}),o(e).click(function(r){t.fnClick!==null&&t.fnClick.call(n,e,t,null,r),t.fnComplete!==null&&t.fnComplete.call(n,e,t,null,null),n._fnCollectionHide(e,t)})},_fnHasFlash:function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(e){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==n&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},_fnFlashConfig:function(e,t){var n=this,r=new s.Client;null!==t.fnInit&&t.fnInit.call(this,e,t),r.setHandCursor(!0),"flash_save"==t.sAction?(r.setAction("save"),r.setCharSet("utf16le"==t.sCharSet?"UTF16LE":"UTF8"),r.setBomInc(t.bBomInc),r.setFileName(t.sFileName.replace("*",this.fnGetTitle(t)))):"flash_pdf"==t.sAction?(r.setAction("pdf"),r.setFileName(t.sFileName.replace("*",this.fnGetTitle(t)))):r.setAction("copy"),r.addEventListener("mouseOver",function(){t.fnMouseover!==null&&t.fnMouseover.call(n,e,t,r)}),r.addEventListener("mouseOut",function(){t.fnMouseout!==null&&t.fnMouseout.call(n,e,t,r)}),r.addEventListener("mouseDown",function(){t.fnClick!==null&&t.fnClick.call(n,e,t,r)}),r.addEventListener("complete",function(i,s){t.fnComplete!==null&&t.fnComplete.call(n,e,t,r,s),n._fnCollectionHide(e,t)}),null!==t.fnSelect&&TableTools._fnEventListen(this,"select",function(r){t.fnSelect.call(n,e,t,r)}),this._fnFlashGlue(r,e,t.sToolTip)},_fnFlashGlue:function(e,n,r){var i=this,s=n.getAttribute("id");t.getElementById(s)?e.glue(n,r):setTimeout(function(){i._fnFlashGlue(e,n,r)},100)},_fnFlashSetText:function(e,t){var n=this._fnChunkData(t,8192);e.clearText();for(var r=0,i=n.length;r<i;r++)e.appendText(n[r])},_fnColumnTargets:function(e){var t=[],n=this.s.dt,r,i=n.aoColumns;r=i.length;if("function"==typeof e){e=e.call(this,n);for(n=0;n<r;n++)t.push(-1!==o.inArray(n,e)?!0:!1)}else if("object"==typeof e){for(n=0;n<r;n++)t.push(!1);n=0;for(r=e.length;n<r;n++)t[e[n]]=!0}else if("visible"==e)for(n=0;n<r;n++)t.push(i[n].bVisible?!0:!1);else if("hidden"==e)for(n=0;n<r;n++)t.push(i[n].bVisible?!1:!0);else if("sortable"==e)for(n=0;n<r;n++)t.push(i[n].bSortable?!0:!1);else for(n=0;n<r;n++)t.push(!0);return t},_fnNewline:function(e){return"auto"==e.sNewLine?navigator.userAgent.match(/Windows/)?"\r\n":"\n":e.sNewLine},_fnGetDataTablesData:function(e){var t,n,r,s,u,a=[],f="",l=this.s.dt,c,h=RegExp(e.sFieldBoundary,"g"),d=this._fnColumnTargets(e.mColumns);r="undefined"!=typeof e.bSelectedOnly?e.bSelectedOnly:!1;if(e.bHeader){u=[],t=0;for(n=l.aoColumns.length;t<n;t++)d[t]&&(f=l.aoColumns[t].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),f=this._fnHtmlDecode(f),u.push(this._fnBoundData(f,e.sFieldBoundary,h)));a.push(u.join(e.sFieldSeperator))}r=!0;var v;s=this.fnGetSelectedIndexes(),v=(r="none"!==this.s.select.type&&r&&0!==s.length)?s:i.Api?(new i.Api(l)).rows(e.oSelectorOpts).indexes().flatten().toArray():l.oInstance.$("tr",e.oSelectorOpts).map(function(e,t){return l.oInstance.fnGetPosition(t)}).get(),r=0;for(s=v.length;r<s;r++){c=l.aoData[v[r]].nTr,u=[],t=0;for(n=l.aoColumns.length;t<n;t++)d[t]&&(f=l.oApi._fnGetCellData(l,v[r],t,"display"),e.fnCellRender?f=e.fnCellRender(f,t,c,v[r])+"":"string"==typeof f?(f=f.replace(/\n/g," "),f=f.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3"),f=f.replace(/<.*?>/g,"")):f+="",f=f.replace(/^\s+/,"").replace(/\s+$/,""),f=this._fnHtmlDecode(f),u.push(this._fnBoundData(f,e.sFieldBoundary,h)));a.push(u.join(e.sFieldSeperator)),e.bOpenRows&&(t=o.grep(l.aoOpenRows,function(e){return e.nParent===c}),1===t.length&&(f=this._fnBoundData(o("td",t[0].nTr).html(),e.sFieldBoundary,h),a.push(f)))}if(e.bFooter&&null!==l.nTFoot){u=[],t=0;for(n=l.aoColumns.length;t<n;t++)d[t]&&null!==l.aoColumns[t].nTf&&(f=l.aoColumns[t].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,""),f=this._fnHtmlDecode(f),u.push(this._fnBoundData(f,e.sFieldBoundary,h)));a.push(u.join(e.sFieldSeperator))}return a.join(this._fnNewline(e))},_fnBoundData:function(e,t,n){return""===t?e:t+e.replace(n,t+t)+t},_fnChunkData:function(e,t){for(var n=[],r=e.length,i=0;i<r;i+=t)i+t<r?n.push(e.substring(i,i+t)):n.push(e.substring(i,r));return n},_fnHtmlDecode:function(e){if(-1===e.indexOf("&"))return e;var n=t.createElement("div");return e.replace(/&([^\s]*?);/g,function(e,t){return"#"===e.substr(1,1)?String.fromCharCode(Number(t.substr(1))):(n.innerHTML=e,n.childNodes[0].nodeValue)})},_fnPrintStart:function(n){var r=this,i=this.s.dt;this._fnPrintHideNodes(i.nTable),this.s.print.saveStart=i._iDisplayStart,this.s.print.saveLength=i._iDisplayLength,n.bShowAll&&(i._iDisplayStart=0,i._iDisplayLength=-1,i.oApi._fnCalculateEnd&&i.oApi._fnCalculateEnd(i),i.oApi._fnDraw(i));if(""!==i.oScroll.sX||""!==i.oScroll.sY)this._fnPrintScrollStart(i),o(this.s.dt.nTable).bind("draw.DTTT_Print",function(){r._fnPrintScrollStart(i)});var s=i.aanFeatures,u;for(u in s)if("i"!=u&&"t"!=u&&1==u.length)for(var a=0,f=s[u].length;a<f;a++)this.dom.print.hidden.push({node:s[u][a],display:"block"}),s[u][a].style.display="none";o(t.body).addClass(this.classes.print.body),""!==n.sInfo&&this.fnInfo(n.sInfo,3e3),n.sMessage&&o("<div/>").addClass(this.classes.print.message).html(n.sMessage).prependTo("body"),this.s.print.saveScroll=o(e).scrollTop(),e.scrollTo(0,0),o(t).bind("keydown.DTTT",function(e){e.keyCode==27&&(e.preventDefault(),r._fnPrintEnd.call(r,e))})},_fnPrintEnd:function(){var n=this.s.dt,r=this.s.print;this._fnPrintShowNodes();if(""!==n.oScroll.sX||""!==n.oScroll.sY)o(this.s.dt.nTable).unbind("draw.DTTT_Print"),this._fnPrintScrollEnd();e.scrollTo(0,r.saveScroll),o("div."+this.classes.print.message).remove(),o(t.body).removeClass("DTTT_Print"),n._iDisplayStart=r.saveStart,n._iDisplayLength=r.saveLength,n.oApi._fnCalculateEnd&&n.oApi._fnCalculateEnd(n),n.oApi._fnDraw(n),o(t).unbind("keydown.DTTT")},_fnPrintScrollStart:function(){var e=this.s.dt;e.nScrollHead.getElementsByTagName("div")[0].getElementsByTagName("table");var t=e.nTable.parentNode,n;n=e.nTable.getElementsByTagName("thead"),0<n.length&&e.nTable.removeChild(n[0]),null!==e.nTFoot&&(n=e.nTable.getElementsByTagName("tfoot"),0<n.length&&e.nTable.removeChild(n[0])),n=e.nTHead.cloneNode(!0),e.nTable.insertBefore(n,e.nTable.childNodes[0]),null!==e.nTFoot&&(n=e.nTFoot.cloneNode(!0),e.nTable.insertBefore(n,e.nTable.childNodes[1])),""!==e.oScroll.sX&&(e.nTable.style.width=o(e.nTable).outerWidth()+"px",t.style.width=o(e.nTable).outerWidth()+"px",t.style.overflow="visible"),""!==e.oScroll.sY&&(t.style.height=o(e.nTable).outerHeight()+"px",t.style.overflow="visible")},_fnPrintScrollEnd:function(){var e=this.s.dt,t=e.nTable.parentNode;""!==e.oScroll.sX&&(t.style.width=e.oApi._fnStringToCss(e.oScroll.sX),t.style.overflow="auto"),""!==e.oScroll.sY&&(t.style.height=e.oApi._fnStringToCss(e.oScroll.sY),t.style.overflow="auto")},_fnPrintShowNodes:function(){for(var e=this.dom.print.hidden,t=0,n=e.length;t<n;t++)e[t].node.style.display=e[t].display;e.splice(0,e.length)},_fnPrintHideNodes:function(e){for(var t=this.dom.print.hidden,n=e.parentNode,r=n.childNodes,i=0,s=r.length;i<s;i++)if(r[i]!=e&&1==r[i].nodeType){var u=o(r[i]).css("display");"none"!=u&&(t.push({node:r[i],display:u}),r[i].style.display="none")}"BODY"!=n.nodeName.toUpperCase()&&this._fnPrintHideNodes(n)}},TableTools._aInstances=[],TableTools._aListeners=[],TableTools.fnGetMasters=function(){for(var e=[],t=0,n=TableTools._aInstances.length;t<n;t++)TableTools._aInstances[t].s.master&&e.push(TableTools._aInstances[t]);return e},TableTools.fnGetInstance=function(e){"object"!=typeof e&&(e=t.getElementById(e));for(var n=0,r=TableTools._aInstances.length;n<r;n++)if(TableTools._aInstances[n].s.master&&TableTools._aInstances[n].dom.table==e)return TableTools._aInstances[n];return null},TableTools._fnEventListen=function(e,t,n){TableTools._aListeners.push({that:e,type:t,fn:n})},TableTools._fnEventDispatch=function(e,t,n,r){for(var i=TableTools._aListeners,s=0,o=i.length;s<o;s++)e.dom.table==i[s].that.dom.table&&i[s].type==t&&i[s].fn(n,r)},TableTools.buttonBase={sAction:"text",sTag:"default",sLinerTag:"default",sButtonClass:"DTTT_button_text",sButtonText:"Button text",sTitle:"",sToolTip:"",sCharSet:"utf8",bBomInc:!1,sFileName:"*.csv",sFieldBoundary:"",sFieldSeperator:"	",sNewLine:"auto",mColumns:"all",bHeader:!0,bFooter:!0,bOpenRows:!1,bSelectedOnly:!1,oSelectorOpts:n,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null,fnCellRender:null},TableTools.BUTTONS={csv:o.extend({},TableTools.buttonBase,{sAction:"flash_save",sButtonClass:"DTTT_button_csv",sButtonText:"CSV",sFieldBoundary:'"',sFieldSeperator:",",fnClick:function(e,t,n){this.fnSetText(n,this.fnGetTableData(t))}}),xls:o.extend({},TableTools.buttonBase,{sAction:"flash_save",sCharSet:"utf16le",bBomInc:!0,sButtonClass:"DTTT_button_xls",sButtonText:"Excel",fnClick:function(e,t,n){this.fnSetText(n,this.fnGetTableData(t))}}),copy:o.extend({},TableTools.buttonBase,{sAction:"flash_copy",sButtonClass:"DTTT_button_copy",sButtonText:"Copy",fnClick:function(e,t,n){this.fnSetText(n,this.fnGetTableData(t))},fnComplete:function(e,t,n,r){e=r.split("\n").length,t.bHeader&&e--,null!==this.s.dt.nTFoot&&t.bFooter&&e--,this.fnInfo("<h6>Table copied</h6><p>Copied "+e+" row"+(1==e?"":"s")+" to the clipboard.</p>",1500)}}),pdf:o.extend({},TableTools.buttonBase,{sAction:"flash_pdf",sNewLine:"\n",sFileName:"*.pdf",sButtonClass:"DTTT_button_pdf",sButtonText:"PDF",sPdfOrientation:"portrait",sPdfSize:"A4",sPdfMessage:"",fnClick:function(e,t,n){this.fnSetText(n,"title:"+this.fnGetTitle(t)+"\nmessage:"+t.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(t)+"\norientation:"+t.sPdfOrientation+"\nsize:"+t.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(t))}}),print:o.extend({},TableTools.buttonBase,{sInfo:"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.</p>",sMessage:null,bShowAll:!0,sToolTip:"View print view",sButtonClass:"DTTT_button_print",sButtonText:"Print",fnClick:function(e,t){this.fnPrint(!0,t)}}),text:o.extend({},TableTools.buttonBase),select:o.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(e){0!==this.fnGetSelected().length?o(e).removeClass(this.classes.buttons.disabled):o(e).addClass(this.classes.buttons.disabled)},fnInit:function(e){o(e).addClass(this.classes.buttons.disabled)}}),select_single:o.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(e){1==this.fnGetSelected().length?o(e).removeClass(this.classes.buttons.disabled):o(e).addClass(this.classes.buttons.disabled)},fnInit:function(e){o(e).addClass(this.classes.buttons.disabled)}}),select_all:o.extend({},TableTools.buttonBase,{sButtonText:"Select all",fnClick:function(){this.fnSelectAll()},fnSelect:function(e){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?o(e).addClass(this.classes.buttons.disabled):o(e).removeClass(this.classes.buttons.disabled)}}),select_none:o.extend({},TableTools.buttonBase,{sButtonText:"Deselect all",fnClick:function(){this.fnSelectNone()},fnSelect:function(e){0!==this.fnGetSelected().length?o(e).removeClass(this.classes.buttons.disabled):o(e).addClass(this.classes.buttons.disabled)},fnInit:function(e){o(e).addClass(this.classes.buttons.disabled)}}),ajax:o.extend({},TableTools.buttonBase,{sAjaxUrl:"/xhr.php",sButtonText:"Ajax button",fnClick:function(e,t){var n=this.fnGetTableData(t);o.ajax({url:t.sAjaxUrl,data:[{name:"tableData",value:n}],success:t.fnAjaxComplete,dataType:"json",type:"POST",cache:!1,error:function(){alert("Error detected when sending table data to server")}})},fnAjaxComplete:function(){alert("Ajax complete")}}),div:o.extend({},TableTools.buttonBase,{sAction:"div",sTag:"div",sButtonClass:"DTTT_nonbutton",sButtonText:"Text button"}),collection:o.extend({},TableTools.buttonBase,{sAction:"collection",sButtonClass:"DTTT_button_collection",sButtonText:"Collection",fnClick:function(e,t){this._fnCollectionShow(e,t)}})},TableTools.buttons=TableTools.BUTTONS,TableTools.classes={container:"DTTT_container",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"},collection:{container:"DTTT_collection",background:"DTTT_collection_background",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"}},select:{table:"DTTT_selectable",row:"DTTT_selected selected"},print:{body:"DTTT_Print",info:"DTTT_print_info",message:"DTTT_PrintMessage"}},TableTools.classes_themeroller={container:"DTTT_container ui-buttonset ui-buttonset-multi",buttons:{normal:"DTTT_button ui-button ui-state-default"},collection:{container:"DTTT_collection ui-buttonset ui-buttonset-multi"}},TableTools.DEFAULTS={sSwfPath:"../swf/copy_csv_xls_pdf.swf",sRowSelect:"none",sRowSelector:"tr",sSelectedClass:null,fnPreRowSelect:null,fnRowSelected:null,fnRowDeselected:null,aButtons:["copy","csv","xls","pdf","print"],oTags:{container:"div",button:"a",liner:"span",collection:{container:"div",button:"a",liner:"span"}}},TableTools.defaults=TableTools.DEFAULTS,TableTools.prototype.CLASS="TableTools",TableTools.version="2.2.4",o.fn.dataTable.Api&&o.fn.dataTable.Api.register("tabletools()",function(){var e=null;return 0<this.context.length&&(e=TableTools.fnGetInstance(this.context[0].nTable)),e}),"function"==typeof o.fn.dataTable&&"function"==typeof o.fn.dataTableExt.fnVersionCheck&&o.fn.dataTableExt.fnVersionCheck("1.9.0")?o.fn.dataTableExt.aoFeatures.push({fnInit:function(e){var t=e.oInit;return(new TableTools(e.oInstance,t?t.tableTools||t.oTableTools||{}:{})).dom.container},cFeature:"T",sFeature:"TableTools"}):alert("Warning: TableTools requires DataTables 1.9.0 or newer - www.datatables.net/download"),o.fn.DataTable.TableTools=TableTools,"function"==typeof r.fn.dataTable&&"function"==typeof r.fn.dataTableExt.fnVersionCheck&&r.fn.dataTableExt.fnVersionCheck("1.9.0")?r.fn.dataTableExt.aoFeatures.push({fnInit:function(e){return e=new TableTools(e.oInstance,"undefined"!=typeof e.oInit.oTableTools?e.oInit.oTableTools:{}),TableTools._aInstances.push(e),e.dom.container},cFeature:"T",sFeature:"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download"),r.fn.dataTable.TableTools=TableTools,r.fn.DataTable.TableTools=TableTools};"function"==typeof define&&define.amd?define(["jquery","datatables"],r):"object"==typeof exports?r(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.TableTools&&r(jQuery,jQuery.fn.dataTable)})(window,document);