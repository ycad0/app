/*!
 KeyTable 1.2.1
 Â©2010-2014 SpryMedia Ltd - datatables.net/license
*/

var KeyTable;(function(e,t,n){var r=function(r){return KeyTable=function(i){function s(e){return function(t,n,r){null!==t&&"number"!=typeof t||null!==n&&"number"!=typeof n||"function"!=typeof r?"object"==typeof t&&"function"==typeof n?(t=v(t),T[e].push({x:t[0],y:t[1],fn:n})):alert("Unhandable event type was added: x"+t+"  y:"+n+"  z:"+r):T[e].push({x:t,y:n,fn:r})}}function o(e){return function(t,n,r){null!==t&&"number"!=typeof t||null!==n&&"number"!=typeof n?"object"==typeof t?(t=v(t),"function"==typeof n?u(e,t[0],t[1],n):u(e,t[0],t[1])):alert("Unhandable event type was removed: x"+t+"  y:"+n+"  z:"+r):"function"==typeof r?u(e,t,n,r):u(e,t,n)}}function u(e,t,n,r){for(var i=0,s=0,o=T[e].length;s<o-i;s++)if("undefined"!=typeof r)T[e][s-i].x==t&&T[e][s-i].y==n&&T[e][s-i].fn==r&&(T[e].splice(s-i,1),i++);else if(T[e][s-i].x==t&&T[e][s-i].y==n)return T[e].splice(s,1),1;return i}function a(e,t,n){for(var r=0,e=T[e],i=0;i<e.length;i++)if(e[i].x==t&&e[i].y==n||null===e[i].x&&e[i].y==n||e[i].x==t&&null===e[i].y||null===e[i].x&&null===e[i].y)e[i].fn(p(t,n),t,n),r++;return r}function f(n,i){if(y!=n){"undefined"==typeof i&&(i=!0),null!==y&&c(y),r(n).addClass(S),r(n).parent().addClass(S);var s;if(N){s=N;for(var o=m(n)[1],u=x;o>=s.fnDisplayEnd();)0<=s._iDisplayLength?s._iDisplayStart+s._iDisplayLength<s.fnRecordsDisplay()&&(s._iDisplayStart+=s._iDisplayLength):s._iDisplayStart=0,N.oApi._fnCalculateEnd(s);for(;o<s._iDisplayStart;)s._iDisplayStart=0<=s._iDisplayLength?s._iDisplayStart-s._iDisplayLength:0,0>s._iDisplayStart&&(s._iDisplayStart=0),N.oApi._fnCalculateEnd(s);N.oApi._fnDraw(s),x=u}o=v(n),y=n,b=o[0],w=o[1];var f,l,h,p,g;if(i){f=r(e).height(),o=r(e).width(),l=r(t).scrollTop(),u=r(t).scrollLeft(),h=n.offsetHeight,p=n.offsetWidth,g=n;var E=0,T=0;if(g.offsetParent){E=g.offsetLeft,T=g.offsetTop;for(g=g.offsetParent;g;)E+=g.offsetLeft,T+=g.offsetTop,g=g.offsetParent}g=[E,T],N&&"undefined"!=typeof s.oScroll&&(""!==s.oScroll.sX||""!==s.oScroll.sY)&&(g[1]-=r(s.nTable.parentNode).scrollTop(),g[0]-=r(s.nTable.parentNode).scrollLeft()),g[1]+h>l+f?(f=g[1]+h-f,t.documentElement.scrollTop=f,t.body.scrollTop=f):g[1]<l&&(f=g[1],t.documentElement.scrollTop=f,t.body.scrollTop=f),g[0]+p>u+o?(o=g[0]+p-o,t.documentElement.scrollLeft=o,t.body.scrollLeft=o):g[0]<u&&(o=g[0],t.documentElement.scrollLeft=o,t.body.scrollLeft=o)}N&&"undefined"!=typeof s.oScroll&&(""!==s.oScroll.sX||""!==s.oScroll.sY)&&((s=s.nTable.parentNode,f=s.clientHeight,o=s.clientWidth,l=s.scrollTop,u=s.scrollLeft,h=n.offsetHeight,p=n.offsetWidth,n.offsetTop+h>f+l?s.scrollTop=n.offsetTop+h-f:n.offsetTop<l&&(s.scrollTop=n.offsetTop),n.offsetLeft+p>o+u)?s.scrollLeft=n.offsetLeft+p-o:n.offsetLeft<u&&(s.scrollLeft=n.offsetLeft)),x||(x=!0),a("focus",b,w)}}function l(){c(y),y=w=b=null,x=!1}function c(e){r(e).removeClass(S),r(e).parent().removeClass(S),a("blur",b,w)}function h(){for(var e=this;"TD"!=e.nodeName;)e=e.parentNode;f(e),x||(x=!0)}function p(e,t){return N?"undefined"!=typeof N.aoData[N.aiDisplay[t]]?N.aoData[N.aiDisplay[t]].nTr.getElementsByTagName("td")[e]:null:r("tr:eq("+t+")>td:eq("+e+")",g)[0]}function v(e){return N?[r("td",e.parentNode).index(e),r("tr",e.parentNode.parentNode).index(e.parentNode)+N._iDisplayStart]:[r("td",e.parentNode).index(e),r("tr",e.parentNode.parentNode).index(e.parentNode)]}function m(e){for(var t=0,n=N.aiDisplay.length;t<n;t++)for(var r=N.aoData[N.aiDisplay[t]].nTr.getElementsByTagName("td"),i=0,s=r.length;i<s;i++)if(r[i]==e)return[i,t];return null}this.block=!1,this.event={remove:{}},this.fnGetCurrentPosition=function(){return[b,w]},this.fnGetCurrentData=function(){return y.innerHTML},this.fnGetCurrentTD=function(){return y},this.fnSetPosition=function(e,t){"object"==typeof e&&e.nodeName?f(e):f(p(e,t))},this.fnBlur=function(){l()};var g=null,y=null,b=null,w=null,E=null,S="focus",x=!1,T={action:[],esc:[],focus:[],blur:[]},N=null,C,k,L=!1,A;for(A in T)A&&(this.event[A]=s(A),this.event.remove[A]=o(A));var O;i===n?(A=r("table.KeyTable")[0],O=null):r.isPlainObject(i)?(A=i.table,O=i.datatable):(O=(new r.fn.dataTable.Api(i)).settings()[0],A=O.nTable);var M=i,E=this;"undefined"==typeof M&&(M={}),"undefined"==typeof M.focus&&(M.focus=[0,0]),M.table=A,r(M.table).addClass("KeyTable"),"undefined"!=typeof M.focusClass&&(S=M.focusClass),"undefined"!=typeof O&&(N=O),"undefined"==typeof M.initScroll&&(M.initScroll=!0),"undefined"==typeof M.form&&(M.form=!1),C=M.form,g=M.table.getElementsByTagName("tbody")[0],C?(i=t.createElement("div"),k=t.createElement("input"),i.style.height="1px",i.style.width="0px",i.style.overflow="hidden","undefined"!=typeof M.tabIndex&&(k.tabIndex=M.tabIndex),i.appendChild(k),M.table.parentNode.insertBefore(i,M.table.nextSibling),r(k).focus(function(){L||(x=!0,L=!1,typeof M.focus.nodeName!="undefined"?f(M.focus,M.initScroll):f(p(M.focus[0],M.focus[1]),M.initScroll),setTimeout(function(){k.blur()},0))}),x=!1):("undefined"!=typeof M.focus.nodeName?f(M.focus,M.initScroll):f(p(M.focus[0],M.focus[1]),M.initScroll),x||(x=!0)),r(t).bind("keydown",function(e){if(E.block||!x||e.metaKey||e.altKey||e.ctrlKey)return!0;var t;t=g.getElementsByTagName("tr")[0].getElementsByTagName("td").length;var n;if(N){n=N.aiDisplay.length;var r=m(y);if(r===null)return;b=r[0],w=r[1]}else n=g.getElementsByTagName("tr").length;r=e.keyCode==9&&e.shiftKey?-1:e.keyCode;switch(r){case 13:return e.preventDefault(),e.stopPropagation(),a("action",b,w),!0;case 27:if(!a("esc",b,w)){l();return}e=b,t=w;break;case-1:case 37:if(b>0)e=b-1,t=w;else{if(!(w>0))return r==-1&&C?(L=!0,k.focus(),setTimeout(function(){L=!1},0),x=!1,l(),!0):!1;e=t-1,t=w-1}break;case 38:if(!(w>0))return!1;e=b,t=w-1;break;case 36:e=b,t=0;break;case 33:e=b,t=w-10,t<0&&(t=0);break;case 9:case 39:if(b<t-1)e=b+1,t=w;else{if(!(w<n-1))return r==9&&C?(L=!0,k.focus(),setTimeout(function(){L=!1},0),x=!1,l(),!0):!1;e=0,t=w+1}break;case 40:if(!(w<n-1))return!1;e=b,t=w+1;break;case 35:e=b,t=n-1;break;case 34:e=b,t=w+10,t>n-1&&(t=n-1);break;default:return!0}return f(p(e,t)),!1}),N?r(N.nTable).on("click","td",h):r(g).on("click","td",h),r(t).click(function(e){for(var e=e.target,t=!1;e;){if(e==M.table){t=!0;break}e=e.parentNode}t||l()})},KeyTable.version="1.2.1",r.fn.dataTable.KeyTable=KeyTable,r.fn.DataTable.KeyTable=KeyTable};"function"==typeof define&&define.amd?define(["jquery","datatables"],r):"object"==typeof exports?r(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&r(jQuery,jQuery.fn.dataTable)})(window,document);